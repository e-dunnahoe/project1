---
title: 'Project 1: Wrangling, Exploration, Visualization'
author: "SDS322E"
date: ''
output:
  html_document:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
  pdf_document:
    toc: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, fig.align = "center", warning = F, message = F,
tidy=TRUE, tidy.opts=list(width.cutoff=60), R.options=list(max.print=100))
```

## Data Wrangling, Exploration, Visualization

### Emily Dunnahoe ekd489

#### Introduction 

Is bigfoot an alien? This is the riveting question that this wrangling, exploring, and visualizing activity is hoping to answer. Okay, not this question exactly, but I will look at whether there is correlation between paranormal sightings and particular regions in the US. To this end, I will consider the dates, longitudes, latitudes, cities, and states to eke out any possible meaning. 

```{R}
UFO_sightings<-read.csv("https://query.data.world/s/kt4hdqddosnopecjgfcm2j3qk3ixek", header=TRUE, stringsAsFactors=FALSE);
big_foot<-read.csv("https://query.data.world/s/72wj67foxle6ztzeirnbdz6kpomzag", header=TRUE, stringsAsFactors=FALSE);

```

#### Tidying: Reshaping

My data is already technically cleaned, except for column with an unneeded date_time. I will separate and remove the time aspect from the UFO_sightings data, before removing any unnecessary variables for both datasets for ease of joining later. Additionally, I coerced R to view the longitude and latitudes as numeric variables to allow for appropriate dplyr shenanigans. Due to the the size of my dataset, I decided to take a slice of 500 observations from each to make it more manageable. 

```{R}
library(tidyverse)
big_foot %>%
  select(-c(2,5,6,10:28)) %>% 
  add_column(paratype= "bigfoot") ->big_foot_clean
big_foot_clean %>% 
  na.omit() %>% 
  slice(1:500)->big_foot_clean

UFO_sightings %>% 
  separate("date_time", into=c("date", "NA"), sep="T")->UFO_sightings_clean

  as.numeric(as.character(UFO_sightings_clean$city_longitude))->longitude
  as.numeric(as.character(UFO_sightings_clean$city_latitude))->latitude 
UFO_sightings_clean %>% 
  add_column(paratype= "UFO")%>% 
  select(-c(5:11)) %>% 
  na.omit() %>% 
  slice(1:500)->UFO_sightings_clean 


```

    
#### Joining/Merging

```{R}
library(plyr)

big_foot_clean %>% 
  full_join(UFO_sightings_clean, by=c("latitude"="city_latitude", "longitude"="city_longitude", "state"="state", "paratype"="paratype", "date"="date", "observed"="summary"))->big_clean_UFO
```


```{R}
library(tidyverse)
library(stringr)
big_clean_UFO %>% 
  group_by(state) %>% 
  summarise(mean.lat=mean(latitude),mean.long=mean(longitude),var.lat=var(latitude), var.long= var(longitude), na.rm=F)->dply.stats
  
big_clean_UFO %>% 
  filter(state==c("New York", "NY")) %>% 
  mutate(state=str_replace(state, "New York", "NY"))->big_clean_UFO_NY

```
I 


#### Visualizing

```{R}
install.packages("usmap")
install.packages("rgdal")
library(usmap)
big_clean_UFO %>% 
  select(longitude, latitude, "paratype")->please.work
  para_map <- usmap_transform(please.work)
plot_usmap() +
  geom_point(data = para_map, aes(x = longitude.1, y = latitude.1, color= paratype), alpha = 0.25)

```

The plot above was supposed to show the paranormal sightings across the United States and to clearly see the distinctly of incidence in particular regions. 

```{R}
# your plot 2
```

Your discussion of plot 2

```{R}
# your plot 3
```

Your discussion of plot 3

#### Concluding Remarks

If any!




